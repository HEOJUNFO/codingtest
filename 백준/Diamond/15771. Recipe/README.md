# [Diamond IV] Recipe - 15771 

[문제 링크](https://www.acmicpc.net/problem/15771) 

### 성능 요약

메모리: 7052 KB, 시간: 520 ms

### 분류

볼록 껍질을 이용한 최적화, 자료 구조, 다이나믹 프로그래밍, 세그먼트 트리

### 제출 일자

2025년 2월 11일 14:18:49

### 문제 설명

<p>재민이는 요리를 좋아한다. 그는 <em>N</em>일 동안 여러 조리법을 개발하려고 한다. 그가 조리법을 개발하는 방법은 다음과 같다.</p>

<ul>
	<li>시장에서 식재료를 사 냉장고에 넣는다.</li>
	<li>조리법을 생각한다.</li>
	<li>냉장고에서 식재료를 꺼내 요리를 한다.</li>
</ul>

<p>이렇게 간단한 방법으로 조리법을 개발할 수 있는 그는 최대한 맛있는 요리들을 만들려고 한다.</p>

<p>시장에서는 매일 새로운 종류의 식재료가 판매된다. <em>i</em>번째 날 판매되는 식재료는 신선도 <em>F<sub>i</sub></em>를 가지고 있다. 만약 식재료를 사서 냉장고에 보관한다면 하루가 지날 때마다 신선도 <em>F<sub>i</sub></em>가 1씩 감소한다. 재민이는 냉장고에 식재료가 있다면 그 재료로 요리를 하기 전에는 또 식재료를 사지 않는다.</p>

<p>재민이는 <em>i</em>번째 날 <em>C<sub>i</sub></em>만큼의 요리실력을 가진다. 그의 요리실력은 꾸준히 증가하기 때문에 <em>i</em> < <em>j</em>인 <em>i</em>, <em>j</em>에 대해서 0 < <em>C<sub>i</sub></em> ≤ <em>C<sub>j</sub></em>를 만족한다. 만약 그가 신선도 <em>F</em>를 가진 식재료를 냉장고에서 꺼내 요리실력 <em>C</em>를 가지고 요리를 하면 <em>F</em> × <em>C</em> 만큼의 맛을 가진 요리가 만들어진다. 그가 요리할 때에는 친구 재현이를 초대하는데 재현이는 매우 위생적이어서 재민이의 냉장고에 있는 식재료가 <em>L<sub>i</sub></em> 이상의 신선도를 가지고 있기를 바란다. 만약 냉장고에 있는 식재료가 그 기준을 만족하지 못한다면 재민이는 그날 요리할 수 없다. 재현이의 요구사항은 매일매일 바뀌어서 <em>N</em> 일 동안의 기준은 <em>L</em><sub>1</sub>, <em>L</em><sub>2</sub>, ..., <em>L<sub>N</sub></em>으로 주어진다.</p>

<p>그는 새로운 요리를 만들고 나면 다음 날 바로 시장에 가서 식재료를 구매하고 또 다른 조리법을 생각한다. 재민이는 날마다 시장에 가서 식재료를 구매하거나, 요리를 하거나, 조리법을 고안하느라 아무것도 안 할 수도 있다 (식재료를 구매한 날 바로 요리를 하는 것도 가능하다). 재민이는 첫째 날에는 냉장고에 식재료가 없기 때문에 시장에 가서 식재료를 구매하고 <em>N</em> 번째 날에는 반드시 요리해서 냉장고를 비운다. 재민이가 만드는 요리들의 맛의 합의 최댓값을 구해보자. 만약 재현이의 까탈스런 요구사항 때문에 <em>N</em> 번째 날에 냉장고를 비울 수 없다면 "<code>Impossible</code>" (따옴표 제외)을 출력한다.</p>

### 입력 

 <p>입력은 4개의 줄로 이루어져 있다.</p>

<p>첫째 줄에는 <em>N</em>이 주어진다.</p>

<p>둘째 줄에는 공백으로 구분된 <em>N</em>개의 수 <em>F</em><sub>1</sub>, <em>F</em><sub>2</sub>, ..., <em>F<sub>N</sub></em>이 공백으로 구분되어 주어진다.</p>

<p>셋째 줄에는 공백으로 구분된 <em>N</em>개의 수 <em>C</em><sub>1</sub>, <em>C</em><sub>2</sub>, ..., <em>C<sub>N</sub></em>이 공백으로 구분되어 주어진다.</p>

<p>넷째 줄에는 공백으로 구분된 <em>N</em>개의 수 <i>L</i><sub>1</sub>, <em>L</em><sub>2</sub>, ..., <em>L<sub>N</sub></em>이 공백으로 구분되어 주어진다.</p>

### 출력 

 <p>재민이가 만드는 요리들의 맛의 합의 최댓값을 출력한다.</p>

<p>만약 <em>N</em>번째 날에 냉장고를 비울 수 없다면 "<code>Impossible</code>"(따옴표 제외)을 출력한다.</p>

